<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Signup</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app auth-wrap">
    <div class="topbar auth-topbar" style="padding:12px 24px;">
      <div class="auth-spacer"></div>
      <div class="page-title"><div class="auth-brand"><div class="logo"><svg viewBox="0 0 24 24" aria-hidden="true"><rect x="3" y="3" width="18" height="18" rx="4"></rect><path d="M7 8h10M7 12h10M7 16h6" stroke-width="2" stroke="currentColor" fill="none"></path></svg></div><span class="workspace-name">TaskMaster</span></div></div>
      <div class="topbar-actions">
        <label class="theme-toggle" title="Toggle dark mode">
          <input type="checkbox" id="theme-toggle" />
          <span class="toggle-icon" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M6.76 4.84l-1.8-1.79L3.17 4.84l1.79 1.8 1.8-1.8zM1 13h3v-2H1v2zm10 10h2v-3h-2v3zm7.03-18.16l1.8-1.79 1.79 1.79-1.8 1.8-1.79-1.8zM20 13h3v-2h-3v2zM17.24 19.16l1.8 1.79 1.79-1.79-1.8-1.8-1.79 1.8zM4.84 17.24l-1.79 1.8 1.79 1.79 1.8-1.8-1.8-1.79z" fill="currentColor"></path><path d="M12 4a8 8 0 1 0 8 8c0-.34-.02-.67-.06-1a6 6 0 1 1-6-7c.33-.04.66-.06 1-.06z" fill="currentColor"></path></svg></span>
          <span class="toggle-label">Dark</span>
        </label>
      </div>
    </div>
    <div class="auth-ambient"></div>
    <div class="auth-shell">
      <div class="auth-card">
      <div class="auth-header">
        <h2 class="auth-title">Create your account</h2>
        <p class="auth-subtitle">Join your teamâ€™s workspace</p>
      </div>
      <div class="form-field"><label>Name</label><input id="su-name" class="input" /></div>
      <div class="form-field"><label>Email</label><input id="su-email" class="input" type="email" /></div>
      <div class="form-field"><label>Password</label><input id="su-password" class="input" type="password" /></div>
      <div class="auth-actions"><button class="button" onclick="window.location.href='login.html'">Login</button><button class="button button-primary" id="su-btn">Signup</button></div>
      <div class="auth-footer" id="su-status"></div>
      </div>
    </div>
  </div>
  <script>
    (function(){
      const t = document.getElementById('theme-toggle');
      const saved = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const shouldDark = saved ? saved==='dark' : prefersDark;
      document.documentElement.classList.toggle('dark-theme', shouldDark);
      document.body.classList.toggle('dark-theme', shouldDark);
      if(t) t.checked = shouldDark;
      t && t.addEventListener('change', ()=>{
        const enable = t.checked;
        document.documentElement.classList.toggle('dark-theme', enable);
        document.body.classList.toggle('dark-theme', enable);
        localStorage.setItem('theme', enable?'dark':'light');
      });
    })();
  </script>
  <script>
    document.getElementById('su-btn').addEventListener('click', async () => {
      const name = document.getElementById('su-name').value.trim()
      const email = document.getElementById('su-email').value.trim()
      const password = document.getElementById('su-password').value
      const status = document.getElementById('su-status')
      try{
        const base = (window.location.origin && window.location.origin.startsWith('http')) ? '' : 'http://localhost:3000'
        const res = await fetch(`${base}/api/auth/signup`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ name, email, password }) })
        const json = await res.json()
        if(!res.ok){ status.textContent = json.error || 'Signup failed'; return }
        localStorage.setItem('token', json.token)
        document.cookie = `token=${json.token}; Path=/; Max-Age=${60*60*24*7}`
        window.location.href = 'index.html'
      }catch(e){ status.textContent = 'Network error' }
    })
  </script>
</body>
</html>